?   	github.com/squareup/spirit/cmd/spirit	[no test files]
?   	github.com/squareup/spirit/pkg/metrics	[no test files]
=== RUN   TestCheckAPI
--- PASS: TestCheckAPI (0.00s)
=== RUN   TestConfiguration
--- PASS: TestConfiguration (0.00s)
=== RUN   TestDropAdd
--- PASS: TestDropAdd (0.00s)
=== RUN   TestAddForeignKey
--- PASS: TestAddForeignKey (0.00s)
=== RUN   TestHasForeignKey
--- PASS: TestHasForeignKey (0.01s)
=== RUN   TestPrimaryKey
--- PASS: TestPrimaryKey (0.00s)
=== RUN   TestPrivileges
--- PASS: TestPrivileges (0.00s)
=== RUN   TestRename
--- PASS: TestRename (0.00s)
=== RUN   TestReplicaHealth
    replicahealth_test.go:34: skipping test because REPLICA_DSN not set
--- SKIP: TestReplicaHealth (0.00s)
=== RUN   TestReplicaPrivileges
    replicaprivileges_test.go:20: skipping test because REPLICA_DSN not set
--- SKIP: TestReplicaPrivileges (0.00s)
=== RUN   TestSettings
--- PASS: TestSettings (0.00s)
=== RUN   TestAddTriggers
--- PASS: TestAddTriggers (0.00s)
=== RUN   TestHasTriggers
--- PASS: TestHasTriggers (0.00s)
=== RUN   TestVersion
--- PASS: TestVersion (0.00s)
PASS
ok  	github.com/squareup/spirit/pkg/check	(cached)
=== RUN   TestBasicChecksum
time="2023-09-28T12:42:52-07:00" level=info msg="create BinlogSyncer with config {1753 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000115ae0 0x100a991d0 <nil> false}"
time="2023-09-28T12:42:52-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000001, 1020452) or GTID set <nil>"
time="2023-09-28T12:42:52-07:00" level=info msg="begin to sync binlog from position (binlog.000001, 1020452)"
time="2023-09-28T12:42:52-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 1020452) target-pos=(binlog.000001, 1020452)"
time="2023-09-28T12:42:52-07:00" level=info msg="starting checksum operation, this will require a table lock"
time="2023-09-28T12:42:52-07:00" level=warning msg="trying to acquire table lock, timeout: 30"
time="2023-09-28T12:42:52-07:00" level=info msg="start sync binlog at binlog file (binlog.000001, 1020452)"
time="2023-09-28T12:42:52-07:00" level=warning msg="table lock acquired"
time="2023-09-28T12:42:52-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 1020860) target-pos=(binlog.000001, 1020656)"
time="2023-09-28T12:42:52-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T12:42:52-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 1021064) target-pos=(binlog.000001, 1020860)"
time="2023-09-28T12:42:52-07:00" level=warning msg="table lock released"
time="2023-09-28T12:42:52-07:00" level=info msg="table unlocked, starting checksum"
--- PASS: TestBasicChecksum (0.03s)
=== RUN   TestBasicValidation
time="2023-09-28T12:42:52-07:00" level=info msg="create BinlogSyncer with config {1753 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x140003b0d10 0x100a991d0 <nil> false}"
--- PASS: TestBasicValidation (0.01s)
=== RUN   TestCorruptChecksum
time="2023-09-28T12:42:52-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000001, 1022858) or GTID set <nil>"
time="2023-09-28T12:42:52-07:00" level=info msg="begin to sync binlog from position (binlog.000001, 1022858)"
time="2023-09-28T12:42:52-07:00" level=info msg="start sync binlog at binlog file (binlog.000001, 1022858)"
time="2023-09-28T12:42:52-07:00" level=info msg="create BinlogSyncer with config {1753 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x140003b1ae0 0x100a991d0 <nil> false}"
time="2023-09-28T12:42:52-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000001, 1024935) or GTID set <nil>"
time="2023-09-28T12:42:52-07:00" level=info msg="begin to sync binlog from position (binlog.000001, 1024935)"
time="2023-09-28T12:42:52-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 1024935) target-pos=(binlog.000001, 1024935)"
time="2023-09-28T12:42:52-07:00" level=info msg="starting checksum operation, this will require a table lock"
time="2023-09-28T12:42:52-07:00" level=info msg="start sync binlog at binlog file (binlog.000001, 1024935)"
time="2023-09-28T12:42:52-07:00" level=warning msg="trying to acquire table lock, timeout: 30"
time="2023-09-28T12:42:52-07:00" level=warning msg="table lock acquired"
time="2023-09-28T12:42:52-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 1025343) target-pos=(binlog.000001, 1025139)"
time="2023-09-28T12:42:52-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T12:42:52-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 1025547) target-pos=(binlog.000001, 1025343)"
time="2023-09-28T12:42:52-07:00" level=warning msg="table lock released"
time="2023-09-28T12:42:52-07:00" level=info msg="table unlocked, starting checksum"
time="2023-09-28T12:42:52-07:00" level=error msg="checksum failed"
--- PASS: TestCorruptChecksum (0.03s)
=== RUN   TestBoundaryCases
time="2023-09-28T12:42:52-07:00" level=info msg="create BinlogSyncer with config {1753 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000030570 0x100a991d0 <nil> false}"
time="2023-09-28T12:42:52-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000001, 1027164) or GTID set <nil>"
time="2023-09-28T12:42:52-07:00" level=info msg="begin to sync binlog from position (binlog.000001, 1027164)"
time="2023-09-28T12:42:52-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 1027164) target-pos=(binlog.000001, 1027164)"
time="2023-09-28T12:42:52-07:00" level=info msg="starting checksum operation, this will require a table lock"
time="2023-09-28T12:42:52-07:00" level=info msg="start sync binlog at binlog file (binlog.000001, 1027164)"
time="2023-09-28T12:42:52-07:00" level=warning msg="trying to acquire table lock, timeout: 30"
time="2023-09-28T12:42:52-07:00" level=warning msg="table lock acquired"
time="2023-09-28T12:42:52-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 1027572) target-pos=(binlog.000001, 1027368)"
time="2023-09-28T12:42:52-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T12:42:52-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 1027776) target-pos=(binlog.000001, 1027572)"
time="2023-09-28T12:42:52-07:00" level=warning msg="table lock released"
time="2023-09-28T12:42:52-07:00" level=info msg="table unlocked, starting checksum"
time="2023-09-28T12:42:52-07:00" level=error msg="checksum failed"
time="2023-09-28T12:42:52-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 1028288) target-pos=(binlog.000001, 1028084)"
time="2023-09-28T12:42:52-07:00" level=info msg="starting checksum operation, this will require a table lock"
time="2023-09-28T12:42:52-07:00" level=warning msg="trying to acquire table lock, timeout: 30"
time="2023-09-28T12:42:52-07:00" level=warning msg="table lock acquired"
time="2023-09-28T12:42:52-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 1028492) target-pos=(binlog.000001, 1028288)"
time="2023-09-28T12:42:52-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T12:42:52-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 1028696) target-pos=(binlog.000001, 1028492)"
time="2023-09-28T12:42:52-07:00" level=warning msg="table lock released"
time="2023-09-28T12:42:52-07:00" level=info msg="table unlocked, starting checksum"
--- PASS: TestBoundaryCases (0.04s)
=== RUN   TestChangeDataTypeDatetime
time="2023-09-28T12:42:52-07:00" level=info msg="create BinlogSyncer with config {1753 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x140000988a0 0x100a991d0 <nil> false}"
time="2023-09-28T12:42:52-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000001, 1031928) or GTID set <nil>"
time="2023-09-28T12:42:52-07:00" level=info msg="begin to sync binlog from position (binlog.000001, 1031928)"
time="2023-09-28T12:42:52-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 1031928) target-pos=(binlog.000001, 1031928)"
time="2023-09-28T12:42:52-07:00" level=info msg="starting checksum operation, this will require a table lock"
time="2023-09-28T12:42:52-07:00" level=warning msg="trying to acquire table lock, timeout: 30"
time="2023-09-28T12:42:52-07:00" level=info msg="start sync binlog at binlog file (binlog.000001, 1031928)"
time="2023-09-28T12:42:52-07:00" level=warning msg="table lock acquired"
time="2023-09-28T12:42:52-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 1032350) target-pos=(binlog.000001, 1032139)"
time="2023-09-28T12:42:52-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T12:42:52-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 1032561) target-pos=(binlog.000001, 1032350)"
time="2023-09-28T12:42:52-07:00" level=warning msg="table lock released"
time="2023-09-28T12:42:52-07:00" level=info msg="table unlocked, starting checksum"
time="2023-09-28T12:42:52-07:00" level=info msg="approaching the end of the table, synchronously updating statistics"
--- PASS: TestChangeDataTypeDatetime (0.02s)
PASS
ok  	github.com/squareup/spirit/pkg/checksum	(cached)
=== RUN   TestNewDSN
--- PASS: TestNewDSN (0.00s)
=== RUN   TestNewConn
--- PASS: TestNewConn (0.00s)
=== RUN   TestLockWaitTimeouts
--- PASS: TestLockWaitTimeouts (0.00s)
=== RUN   TestRetryableTrx
--- PASS: TestRetryableTrx (4.89s)
=== RUN   TestTableLock
time="2023-09-28T12:42:57-07:00" level=warning msg="trying to acquire table lock, timeout: 2"
time="2023-09-28T12:42:57-07:00" level=warning msg="table lock acquired"
time="2023-09-28T12:42:57-07:00" level=warning msg="trying to acquire table lock, timeout: 2"
time="2023-09-28T12:42:57-07:00" level=warning msg="table lock acquired"
time="2023-09-28T12:42:57-07:00" level=warning msg="table lock released"
time="2023-09-28T12:42:57-07:00" level=warning msg="table lock released"
--- PASS: TestTableLock (0.01s)
=== RUN   TestTableLockFail
time="2023-09-28T12:42:57-07:00" level=warning msg="trying to acquire table lock, timeout: 1"
--- PASS: TestTableLockFail (0.00s)
=== RUN   TestTrxPool
--- PASS: TestTrxPool (0.01s)
PASS
ok  	github.com/squareup/spirit/pkg/dbconn	(cached)
=== RUN   TestCutOver
time="2023-09-28T13:34:05-07:00" level=info msg="create BinlogSyncer with config {1271 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000030140 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:05-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:05-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 871612886) or GTID set <nil>"
time="2023-09-28T13:34:05-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 871612886)"
time="2023-09-28T13:34:05-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871612886) target-pos=(binlog.000002, 871612886)"
time="2023-09-28T13:34:05-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:05-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:05-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 871612886)"
time="2023-09-28T13:34:05-07:00" level=warning msg="trying to acquire table lock, timeout: 30"
time="2023-09-28T13:34:05-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:05-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:05-07:00" level=warning msg="final cut over operation complete"
--- PASS: TestCutOver (0.02s)
=== RUN   TestCutOverGhostAlgorithm
time="2023-09-28T13:34:05-07:00" level=info msg="create BinlogSyncer with config {1271 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000099840 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:05-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:05-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 871614937) or GTID set <nil>"
time="2023-09-28T13:34:05-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 871614937)"
time="2023-09-28T13:34:05-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 871614937)"
time="2023-09-28T13:34:05-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871615153) target-pos=(binlog.000002, 871614937)"
time="2023-09-28T13:34:05-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:05-07:00" level=info msg="Using cutover algorithm: gh-ost"
time="2023-09-28T13:34:05-07:00" level=warning msg="trying to acquire table lock, timeout: 30"
time="2023-09-28T13:34:05-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:05-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:05-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871615369) target-pos=(binlog.000002, 871615153)"
time="2023-09-28T13:34:05-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:05-07:00" level=warning msg="final cut over operation complete"
--- PASS: TestCutOverGhostAlgorithm (0.02s)
=== RUN   TestMDLLockFails
time="2023-09-28T13:34:05-07:00" level=info msg="create BinlogSyncer with config {1271 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x1400030d0e0 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:05-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 871616997) or GTID set <nil>"
time="2023-09-28T13:34:05-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 871616997)"
time="2023-09-28T13:34:05-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:05-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 871616997)"
time="2023-09-28T13:34:05-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871616997) target-pos=(binlog.000002, 871616997)"
time="2023-09-28T13:34:05-07:00" level=warning msg="Attempting final cut over operation (attempt 1/2)"
time="2023-09-28T13:34:05-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:05-07:00" level=warning msg="trying to acquire table lock, timeout: 1"
time="2023-09-28T13:34:06-07:00" level=warning msg="failed trying to acquire table lock, backing off and retrying: Error 1205 (HY000): Lock wait timeout exceeded; try restarting transaction"
time="2023-09-28T13:34:06-07:00" level=warning msg="trying to acquire table lock, timeout: 1"
time="2023-09-28T13:34:07-07:00" level=warning msg="failed trying to acquire table lock, backing off and retrying: Error 1205 (HY000): Lock wait timeout exceeded; try restarting transaction"
time="2023-09-28T13:34:07-07:00" level=warning msg="cutover failed. err: Error 1205 (HY000): Lock wait timeout exceeded; try restarting transaction"
time="2023-09-28T13:34:07-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:07-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871617417) target-pos=(binlog.000002, 871617207)"
time="2023-09-28T13:34:07-07:00" level=warning msg="Attempting final cut over operation (attempt 2/2)"
time="2023-09-28T13:34:07-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:07-07:00" level=warning msg="trying to acquire table lock, timeout: 1"
time="2023-09-28T13:34:08-07:00" level=warning msg="failed trying to acquire table lock, backing off and retrying: Error 1205 (HY000): Lock wait timeout exceeded; try restarting transaction"
time="2023-09-28T13:34:08-07:00" level=warning msg="trying to acquire table lock, timeout: 1"
time="2023-09-28T13:34:09-07:00" level=warning msg="failed trying to acquire table lock, backing off and retrying: Error 1205 (HY000): Lock wait timeout exceeded; try restarting transaction"
time="2023-09-28T13:34:09-07:00" level=warning msg="cutover failed. err: Error 1205 (HY000): Lock wait timeout exceeded; try restarting transaction"
time="2023-09-28T13:34:09-07:00" level=error msg="cutover failed, and retries exhausted"
--- PASS: TestMDLLockFails (4.04s)
=== RUN   TestInvalidOptions
--- PASS: TestInvalidOptions (0.00s)
=== RUN   TestE2ENullAlterEmpty
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.t1 alter=\"ENGINE=InnoDB\""
time="2023-09-28T13:34:09-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_t1_new'"
time="2023-09-28T13:34:09-07:00" level=info msg="create BinlogSyncer with config {1610 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000030ce0 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:09-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 871619862) or GTID set <nil>"
time="2023-09-28T13:34:09-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 871619862)"
time="2023-09-28T13:34:09-07:00" level=info msg="approaching the end of the table, synchronously updating statistics"
time="2023-09-28T13:34:09-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 871619862)"
time="2023-09-28T13:34:09-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871620238) target-pos=(binlog.000002, 871620034)"
time="2023-09-28T13:34:09-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_t1_new`"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871620619) target-pos=(binlog.000002, 871620415)"
time="2023-09-28T13:34:09-07:00" level=info msg="starting checksum operation, this will require a table lock"
time="2023-09-28T13:34:09-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871620823) target-pos=(binlog.000002, 871620619)"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871621027) target-pos=(binlog.000002, 871620823)"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:09-07:00" level=info msg="table unlocked, starting checksum"
time="2023-09-28T13:34:09-07:00" level=info msg="checksum passed"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871621231) target-pos=(binlog.000002, 871621027)"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871621645) target-pos=(binlog.000002, 871621441)"
time="2023-09-28T13:34:09-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:09-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:09-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:09-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:09-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:09-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=2 copy-rows-time=0s checksum-time=0s total-time=0s"
time="2023-09-28T13:34:09-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:09-07:00" level=info msg="kill last connection id 4699"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closed"
--- PASS: TestE2ENullAlterEmpty (0.08s)
=== RUN   TestMissingAlter
--- PASS: TestMissingAlter (0.00s)
=== RUN   TestBadDatabaseCredentials
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.t1 alter=\"ENGINE=InnoDB\""
--- PASS: TestBadDatabaseCredentials (0.00s)
=== RUN   TestE2ENullAlter1Row
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.t1 alter=\"ENGINE=InnoDB\""
time="2023-09-28T13:34:09-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_t1_new'"
time="2023-09-28T13:34:09-07:00" level=info msg="create BinlogSyncer with config {1610 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000031e10 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:09-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 871626263) or GTID set <nil>"
time="2023-09-28T13:34:09-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 871626263)"
time="2023-09-28T13:34:09-07:00" level=info msg="approaching the end of the table, synchronously updating statistics"
time="2023-09-28T13:34:09-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 871626263)"
time="2023-09-28T13:34:09-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871626930) target-pos=(binlog.000002, 871626726)"
time="2023-09-28T13:34:09-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_t1_new`"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871627311) target-pos=(binlog.000002, 871627107)"
time="2023-09-28T13:34:09-07:00" level=info msg="starting checksum operation, this will require a table lock"
time="2023-09-28T13:34:09-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871627515) target-pos=(binlog.000002, 871627311)"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871627719) target-pos=(binlog.000002, 871627515)"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:09-07:00" level=info msg="table unlocked, starting checksum"
time="2023-09-28T13:34:09-07:00" level=info msg="checksum passed"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871627923) target-pos=(binlog.000002, 871627719)"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871628337) target-pos=(binlog.000002, 871628133)"
time="2023-09-28T13:34:09-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:09-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:09-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:09-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:09-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:09-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=2 copy-rows-time=0s checksum-time=0s total-time=0s"
time="2023-09-28T13:34:09-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:09-07:00" level=info msg="kill last connection id 4727"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closed"
--- PASS: TestE2ENullAlter1Row (0.06s)
=== RUN   TestE2ENullAlterWithReplicas
    migration_test.go:133: skipping replica tests because REPLICA_DSN not set
--- SKIP: TestE2ENullAlterWithReplicas (0.00s)
=== RUN   TestRenameInMySQL80
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.t1 alter=\"CHANGE name nameNew varchar(255) not null\""
time="2023-09-28T13:34:09-07:00" level=info msg="apply complete: instant-ddl=true inplace-ddl=false"
--- PASS: TestRenameInMySQL80 (0.01s)
=== RUN   TestVarcharNonBinaryComparable
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.nonbinarycompatt1 alter=\"ENGINE=InnoDB\""
time="2023-09-28T13:34:09-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_nonbinarycompatt1_new'"
time="2023-09-28T13:34:09-07:00" level=info msg="create BinlogSyncer with config {1610 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000219b40 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:09-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 871632800) or GTID set <nil>"
time="2023-09-28T13:34:09-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 871632800)"
time="2023-09-28T13:34:09-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 871632800)"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871633019) target-pos=(binlog.000002, 871632800)"
time="2023-09-28T13:34:09-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_nonbinarycompatt1_new`"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871633655) target-pos=(binlog.000002, 871633436)"
time="2023-09-28T13:34:09-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:09-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:09-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:09-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:09-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:09-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=1 copy-rows-time=0s checksum-time=0s total-time=0s"
time="2023-09-28T13:34:09-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:09-07:00" level=info msg="kill last connection id 4755"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closed"
--- PASS: TestVarcharNonBinaryComparable (0.03s)
=== RUN   TestVarbinary
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.varbinaryt1 alter=\"ENGINE=InnoDB\""
time="2023-09-28T13:34:09-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_varbinaryt1_new'"
time="2023-09-28T13:34:09-07:00" level=info msg="create BinlogSyncer with config {1610 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000098d70 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:09-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 871637735) or GTID set <nil>"
time="2023-09-28T13:34:09-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 871637735)"
time="2023-09-28T13:34:09-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 871637735)"
time="2023-09-28T13:34:09-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871638478) target-pos=(binlog.000002, 871638265)"
time="2023-09-28T13:34:09-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_varbinaryt1_new`"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871639096) target-pos=(binlog.000002, 871638883)"
time="2023-09-28T13:34:09-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:09-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:09-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:09-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:09-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:09-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=1 copy-rows-time=0s checksum-time=0s total-time=0s"
time="2023-09-28T13:34:09-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:09-07:00" level=info msg="kill last connection id 4763"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closed"
--- PASS: TestVarbinary (0.03s)
=== RUN   TestDataFromBadSqlMode
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.badsqlt1 alter=\"ENGINE=InnoDB\""
time="2023-09-28T13:34:09-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_badsqlt1_new'"
time="2023-09-28T13:34:09-07:00" level=info msg="create BinlogSyncer with config {1610 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x140000997c0 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:09-07:00" level=info msg="approaching the end of the table, synchronously updating statistics"
time="2023-09-28T13:34:09-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 871642879) or GTID set <nil>"
time="2023-09-28T13:34:09-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 871642879)"
time="2023-09-28T13:34:09-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 871642879)"
time="2023-09-28T13:34:09-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871643573) target-pos=(binlog.000002, 871643363)"
time="2023-09-28T13:34:09-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_badsqlt1_new`"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871644182) target-pos=(binlog.000002, 871643972)"
time="2023-09-28T13:34:09-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:09-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:09-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:09-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:09-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:09-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=3 copy-rows-time=0s checksum-time=0s total-time=0s"
time="2023-09-28T13:34:09-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:09-07:00" level=info msg="kill last connection id 4774"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closed"
--- PASS: TestDataFromBadSqlMode (0.04s)
=== RUN   TestChangeDatatypeNoData
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.cdatatypemytable alter=\"CHANGE b b INT\""
time="2023-09-28T13:34:09-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_cdatatypemytable_new'"
time="2023-09-28T13:34:09-07:00" level=info msg="create BinlogSyncer with config {1610 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000218970 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:09-07:00" level=info msg="approaching the end of the table, synchronously updating statistics"
time="2023-09-28T13:34:09-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 871647768) or GTID set <nil>"
time="2023-09-28T13:34:09-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 871647768)"
time="2023-09-28T13:34:09-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 871647768)"
time="2023-09-28T13:34:09-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871648172) target-pos=(binlog.000002, 871647954)"
time="2023-09-28T13:34:09-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_cdatatypemytable_new`"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871648805) target-pos=(binlog.000002, 871648587)"
time="2023-09-28T13:34:09-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:09-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:09-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:09-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:09-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:09-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=2 copy-rows-time=0s checksum-time=0s total-time=0s"
time="2023-09-28T13:34:09-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:09-07:00" level=info msg="kill last connection id 4782"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closed"
--- PASS: TestChangeDatatypeNoData (0.04s)
=== RUN   TestChangeDatatypeDataLoss
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.cdatalossmytable alter=\"CHANGE b b INT\""
time="2023-09-28T13:34:09-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_cdatalossmytable_chkpnt'"
time="2023-09-28T13:34:09-07:00" level=info msg="create BinlogSyncer with config {1610 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000030590 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:09-07:00" level=info msg="approaching the end of the table, synchronously updating statistics"
time="2023-09-28T13:34:09-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 871652769) or GTID set <nil>"
time="2023-09-28T13:34:09-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 871652769)"
time="2023-09-28T13:34:09-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 871652769)"
time="2023-09-28T13:34:09-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:09-07:00" level=info msg="kill last connection id 4791"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closed"
--- PASS: TestChangeDatatypeDataLoss (0.03s)
=== RUN   TestOnline
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.testonline alter=\"CHANGE COLUMN b b int(11) NOT NULL\""
time="2023-09-28T13:34:09-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_testonline_new'"
time="2023-09-28T13:34:09-07:00" level=info msg="create BinlogSyncer with config {1610 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000218a30 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:09-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 871655554) or GTID set <nil>"
time="2023-09-28T13:34:09-07:00" level=info msg="approaching the end of the table, synchronously updating statistics"
time="2023-09-28T13:34:09-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 871655554)"
time="2023-09-28T13:34:09-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 871655554)"
time="2023-09-28T13:34:09-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871655946) target-pos=(binlog.000002, 871655734)"
time="2023-09-28T13:34:09-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_testonline_new`"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871656561) target-pos=(binlog.000002, 871656349)"
time="2023-09-28T13:34:09-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:09-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:09-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:09-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:09-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:09-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=2 copy-rows-time=0s checksum-time=0s total-time=0s"
time="2023-09-28T13:34:09-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:09-07:00" level=info msg="kill last connection id 4798"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closed"
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.testonline2 alter=\"ADD c int(11) NOT NULL\""
time="2023-09-28T13:34:09-07:00" level=info msg="apply complete: instant-ddl=true inplace-ddl=false"
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.testonline3 alter=\"ADD INDEX(b)\""
time="2023-09-28T13:34:09-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=true"
--- PASS: TestOnline (0.05s)
=== RUN   TestTableLength
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.thisisareallylongtablenamethisisareallylongtablename60charac alter=\"ENGINE=InnoDB\""
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.thisisareallylongtablenamethisisareallylongtablename60charac alter=\"ENGINE=InnoDB\""
--- PASS: TestTableLength (0.01s)
=== RUN   TestMigrationStateString
--- PASS: TestMigrationStateString (0.00s)
=== RUN   TestBadOptions
--- PASS: TestBadOptions (0.00s)
=== RUN   TestBadAlter
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.bot1 alter=\"badalter\""
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.bot1 alter=\"RENAME COLUMN name TO name2, ADD INDEX(name)\""
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.bot1 alter=\"CHANGE name name2 VARCHAR(255), ADD INDEX(name)\""
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.bot1 alter=\"CHANGE name name VARCHAR(200), ADD INDEX(name)\""
time="2023-09-28T13:34:09-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_bot1_new'"
time="2023-09-28T13:34:09-07:00" level=info msg="create BinlogSyncer with config {1610 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x140005b2f20 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:09-07:00" level=info msg="approaching the end of the table, synchronously updating statistics"
time="2023-09-28T13:34:09-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 871663805) or GTID set <nil>"
time="2023-09-28T13:34:09-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 871663805)"
time="2023-09-28T13:34:09-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 871663805)"
time="2023-09-28T13:34:09-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871664185) target-pos=(binlog.000002, 871663979)"
time="2023-09-28T13:34:09-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_bot1_new`"
time="2023-09-28T13:34:09-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:09-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871664782) target-pos=(binlog.000002, 871664576)"
time="2023-09-28T13:34:09-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:09-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:09-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:09-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:09-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:09-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:09-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=2 copy-rows-time=0s checksum-time=0s total-time=0s"
time="2023-09-28T13:34:09-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:09-07:00" level=info msg="kill last connection id 4820"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closed"
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.bot2 alter=\"DROP PRIMARY KEY\""
--- PASS: TestBadAlter (0.05s)
=== RUN   TestChangeDatatypeLossyNoAutoInc
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.lossychange2 alter=\"CHANGE COLUMN id id INT NOT NULL auto_increment\""
time="2023-09-28T13:34:09-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_lossychange2_chkpnt'"
time="2023-09-28T13:34:09-07:00" level=info msg="create BinlogSyncer with config {1610 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x140005b2ae0 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:09-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 871669502) or GTID set <nil>"
time="2023-09-28T13:34:09-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 871669502)"
time="2023-09-28T13:34:09-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 871669502)"
time="2023-09-28T13:34:09-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:09-07:00" level=info msg="kill last connection id 4830"
time="2023-09-28T13:34:09-07:00" level=info msg="syncer is closed"
--- PASS: TestChangeDatatypeLossyNoAutoInc (0.03s)
=== RUN   TestChangeDatatypeLossless
time="2023-09-28T13:34:09-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.lossychange3 alter=\"CHANGE COLUMN b b varchar(200) NOT NULL\""
time="2023-09-28T13:34:09-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_lossychange3_new'"
time="2023-09-28T13:34:09-07:00" level=info msg="create BinlogSyncer with config {1610 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x1400068a7a0 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:09-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 871673121) or GTID set <nil>"
time="2023-09-28T13:34:09-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 871673121)"
time="2023-09-28T13:34:09-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 871673121)"
time="2023-09-28T13:34:10-07:00" level=warning msg="dynamic chunking is not working as expected: target-time=100ms p90-time=6.790792ms new-target-rows=1472582 max-dynamic-row-size=100000"
time="2023-09-28T13:34:10-07:00" level=warning msg="switching to prefetch algorithm"
time="2023-09-28T13:34:10-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:10-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:10-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871674351) target-pos=(binlog.000002, 871674137)"
time="2023-09-28T13:34:10-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_lossychange3_new`"
time="2023-09-28T13:34:10-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:10-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871674972) target-pos=(binlog.000002, 871674758)"
time="2023-09-28T13:34:10-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:10-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:10-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:10-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:10-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:10-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:10-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:10-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=337 copy-rows-time=0s checksum-time=0s total-time=0s"
time="2023-09-28T13:34:10-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:10-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:10-07:00" level=info msg="kill last connection id 4841"
time="2023-09-28T13:34:10-07:00" level=info msg="syncer is closed"
--- PASS: TestChangeDatatypeLossless (0.16s)
=== RUN   TestChangeDatatypeLossyFailEarly
time="2023-09-28T13:34:10-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.lossychange4 alter=\"CHANGE COLUMN b b varchar(255) NOT NULL\""
time="2023-09-28T13:34:10-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_lossychange4_chkpnt'"
time="2023-09-28T13:34:10-07:00" level=info msg="create BinlogSyncer with config {1868 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x140005b2050 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:10-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 871679873) or GTID set <nil>"
time="2023-09-28T13:34:10-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 871679873)"
time="2023-09-28T13:34:10-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 871679873)"
time="2023-09-28T13:34:10-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:10-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:10-07:00" level=info msg="kill last connection id 4864"
time="2023-09-28T13:34:10-07:00" level=info msg="syncer is closed"
--- PASS: TestChangeDatatypeLossyFailEarly (0.11s)
=== RUN   TestAddUniqueIndexChecksumEnabled
time="2023-09-28T13:34:10-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.uniqmytable alter=\"ADD UNIQUE INDEX b (b)\""
time="2023-09-28T13:34:10-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_uniqmytable_new'"
time="2023-09-28T13:34:10-07:00" level=info msg="create BinlogSyncer with config {1868 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x1400030cc90 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:10-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 871684454) or GTID set <nil>"
time="2023-09-28T13:34:10-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 871684454)"
time="2023-09-28T13:34:10-07:00" level=info msg="approaching the end of the table, synchronously updating statistics"
time="2023-09-28T13:34:10-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 871684454)"
time="2023-09-28T13:34:10-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:10-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:10-07:00" level=info msg="kill last connection id 4889"
time="2023-09-28T13:34:10-07:00" level=info msg="syncer is closed"
time="2023-09-28T13:34:10-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.uniqmytable alter=\"ADD UNIQUE INDEX b (b)\""
time="2023-09-28T13:34:10-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_uniqmytable_chkpnt'"
time="2023-09-28T13:34:10-07:00" level=info msg="create BinlogSyncer with config {1868 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000030eb0 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:10-07:00" level=info msg="approaching the end of the table, synchronously updating statistics"
time="2023-09-28T13:34:10-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 871687197) or GTID set <nil>"
time="2023-09-28T13:34:10-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 871687197)"
time="2023-09-28T13:34:10-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 871687197)"
time="2023-09-28T13:34:10-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:10-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:10-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871688514) target-pos=(binlog.000002, 871688301)"
time="2023-09-28T13:34:10-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_uniqmytable_new`"
time="2023-09-28T13:34:10-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:10-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871689132) target-pos=(binlog.000002, 871688919)"
time="2023-09-28T13:34:10-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:10-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:10-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:10-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:10-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:10-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:10-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:10-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=3 copy-rows-time=0s checksum-time=0s total-time=0s"
time="2023-09-28T13:34:10-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:10-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:10-07:00" level=info msg="kill last connection id 4898"
time="2023-09-28T13:34:10-07:00" level=info msg="syncer is closed"
--- PASS: TestAddUniqueIndexChecksumEnabled (0.09s)
=== RUN   TestChangeNonIntPK
time="2023-09-28T13:34:10-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.nonintpk alter=\"CHANGE COLUMN b b VARCHAR(255) NOT NULL\""
time="2023-09-28T13:34:10-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_nonintpk_new'"
time="2023-09-28T13:34:10-07:00" level=info msg="create BinlogSyncer with config {1868 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x140005b2ad0 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:10-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 871692993) or GTID set <nil>"
time="2023-09-28T13:34:10-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 871692993)"
time="2023-09-28T13:34:10-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:10-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:10-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 871692993)"
time="2023-09-28T13:34:10-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871693542) target-pos=(binlog.000002, 871693332)"
time="2023-09-28T13:34:10-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_nonintpk_new`"
time="2023-09-28T13:34:10-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:10-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 871694151) target-pos=(binlog.000002, 871693941)"
time="2023-09-28T13:34:10-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:10-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:10-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:10-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:10-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:10-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:10-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:10-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=1 copy-rows-time=0s checksum-time=0s total-time=0s"
time="2023-09-28T13:34:10-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:10-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:10-07:00" level=info msg="kill last connection id 4906"
time="2023-09-28T13:34:10-07:00" level=info msg="syncer is closed"
--- PASS: TestChangeNonIntPK (0.03s)
=== RUN   TestCheckpoint
time="2023-09-28T13:34:10-07:00" level=info msg="create BinlogSyncer with config {1868 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000728d00 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:10-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 882959464) or GTID set <nil>"
time="2023-09-28T13:34:10-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 882959464)"
time="2023-09-28T13:34:10-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 882959464)"
time="2023-09-28T13:34:12-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:12-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:12-07:00" level=info msg="kill last connection id 4919"
time="2023-09-28T13:34:12-07:00" level=info msg="syncer is closed"
--- PASS: TestCheckpoint (2.42s)
=== RUN   TestCheckpointRestore
time="2023-09-28T13:34:12-07:00" level=info msg="create BinlogSyncer with config {1491 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x140007202b0 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:12-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 884301044) or GTID set <nil>"
time="2023-09-28T13:34:12-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 884301044)"
time="2023-09-28T13:34:12-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.cpt2 alter=\"ENGINE=InnoDB\""
time="2023-09-28T13:34:12-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 884301044)"
time="2023-09-28T13:34:12-07:00" level=info msg="create BinlogSyncer with config {1491 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x140008ce220 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:12-07:00" level=warning msg="resuming from checkpoint. low-watermark: {\"Key\":[\"id\"],\"ChunkSize\":1000,\"LowerBound\":{\"Value\":[\"53926425\"],\"Inclusive\":true},\"UpperBound\":{\"Value\":[\"53926425\"],\"Inclusive\":false}} log-file: binlog.000002 log-pos: 884301044 copy-rows: 0"
time="2023-09-28T13:34:12-07:00" level=info msg="approaching the end of the table, synchronously updating statistics"
time="2023-09-28T13:34:12-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 884301044) or GTID set <nil>"
time="2023-09-28T13:34:12-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 884301044)"
time="2023-09-28T13:34:12-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 884301044)"
time="2023-09-28T13:34:12-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:12-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:12-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 884302477) target-pos=(binlog.000002, 884302271)"
time="2023-09-28T13:34:12-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_cpt2_new`"
time="2023-09-28T13:34:12-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 884302862) target-pos=(binlog.000002, 884302656)"
time="2023-09-28T13:34:12-07:00" level=info msg="starting checksum operation, this will require a table lock"
time="2023-09-28T13:34:12-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:12-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:12-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 884303068) target-pos=(binlog.000002, 884302862)"
time="2023-09-28T13:34:12-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:12-07:00" level=info msg="migration status: state=checksum checksum-progress=TBD/0 binlog-deltas=0 total-time=0s checksum-time=0s"
time="2023-09-28T13:34:12-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 884303274) target-pos=(binlog.000002, 884303068)"
time="2023-09-28T13:34:12-07:00" level=info msg="migration status: state=checksum checksum-progress=TBD/0 binlog-deltas=0 total-time=0s checksum-time=0s"
time="2023-09-28T13:34:12-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:12-07:00" level=info msg="table unlocked, starting checksum"
time="2023-09-28T13:34:12-07:00" level=info msg="checksum passed"
time="2023-09-28T13:34:12-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:12-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 884303480) target-pos=(binlog.000002, 884303274)"
time="2023-09-28T13:34:12-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:12-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 884303898) target-pos=(binlog.000002, 884303692)"
time="2023-09-28T13:34:12-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:12-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:12-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:12-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:12-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:12-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:12-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:12-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=1 copy-rows-time=0s checksum-time=0s total-time=0s"
--- PASS: TestCheckpointRestore (0.07s)
=== RUN   TestCheckpointDifferentRestoreOptions
time="2023-09-28T13:34:13-07:00" level=info msg="create BinlogSyncer with config {1952 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x1400056a390 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:13-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 895569347) or GTID set <nil>"
time="2023-09-28T13:34:13-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 895569347)"
time="2023-09-28T13:34:13-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 895569347)"
time="2023-09-28T13:34:13-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":1000,\"LowerBound\":{\"Value\": [\"1001\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"2001\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=895569347 rows-copied=1970 rows-copied-logical=3000"
--- PASS: TestCheckpointDifferentRestoreOptions (0.33s)
=== RUN   TestE2EBinlogSubscribingCompositeKey
time="2023-09-28T13:34:13-07:00" level=info msg="create BinlogSyncer with config {1952 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000776250 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:13-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 895816725) or GTID set <nil>"
time="2023-09-28T13:34:13-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 895816725)"
time="2023-09-28T13:34:13-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 895816725)"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895830531) target-pos=(binlog.000002, 895830324)"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895833915) target-pos=(binlog.000002, 895833708)"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895834408) target-pos=(binlog.000002, 895834201)"
time="2023-09-28T13:34:13-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895835483) target-pos=(binlog.000002, 895835276)"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895835690) target-pos=(binlog.000002, 895835483)"
time="2023-09-28T13:34:13-07:00" level=info msg="starting checksum operation, this will require a table lock"
time="2023-09-28T13:34:13-07:00" level=warning msg="trying to acquire table lock, timeout: 30"
time="2023-09-28T13:34:13-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895835897) target-pos=(binlog.000002, 895835690)"
time="2023-09-28T13:34:13-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895836395) target-pos=(binlog.000002, 895836188)"
time="2023-09-28T13:34:13-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:13-07:00" level=info msg="table unlocked, starting checksum"
time="2023-09-28T13:34:13-07:00" level=info msg="checksum passed"
time="2023-09-28T13:34:13-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895836602) target-pos=(binlog.000002, 895836395)"
--- PASS: TestE2EBinlogSubscribingCompositeKey (0.06s)
=== RUN   TestE2EBinlogSubscribingNonCompositeKey
time="2023-09-28T13:34:13-07:00" level=info msg="create BinlogSyncer with config {1952 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x140000990f0 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:13-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 895839924) or GTID set <nil>"
time="2023-09-28T13:34:13-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 895839924)"
time="2023-09-28T13:34:13-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 895839924)"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895840412) target-pos=(binlog.000002, 895840205)"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895841213) target-pos=(binlog.000002, 895841006)"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895841701) target-pos=(binlog.000002, 895841494)"
time="2023-09-28T13:34:13-07:00" level=info msg="approaching the end of the table, synchronously updating statistics"
time="2023-09-28T13:34:13-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895842936) target-pos=(binlog.000002, 895842729)"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895843143) target-pos=(binlog.000002, 895842936)"
time="2023-09-28T13:34:13-07:00" level=info msg="starting checksum operation, this will require a table lock"
time="2023-09-28T13:34:13-07:00" level=warning msg="trying to acquire table lock, timeout: 30"
time="2023-09-28T13:34:13-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895843350) target-pos=(binlog.000002, 895843143)"
time="2023-09-28T13:34:13-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895843843) target-pos=(binlog.000002, 895843636)"
time="2023-09-28T13:34:13-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:13-07:00" level=info msg="table unlocked, starting checksum"
time="2023-09-28T13:34:13-07:00" level=info msg="checksum passed"
time="2023-09-28T13:34:13-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895844050) target-pos=(binlog.000002, 895843843)"
--- PASS: TestE2EBinlogSubscribingNonCompositeKey (0.06s)
=== RUN   TestForRemainingTableArtifacts
time="2023-09-28T13:34:13-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.remainingtbl alter=\"ENGINE=InnoDB\""
time="2023-09-28T13:34:13-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_remainingtbl_new'"
time="2023-09-28T13:34:13-07:00" level=info msg="create BinlogSyncer with config {1952 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x140000f2d90 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:13-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 895846643) or GTID set <nil>"
time="2023-09-28T13:34:13-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 895846643)"
time="2023-09-28T13:34:13-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:13-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:13-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 895846643)"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895846857) target-pos=(binlog.000002, 895846643)"
time="2023-09-28T13:34:13-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_remainingtbl_new`"
time="2023-09-28T13:34:13-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895847478) target-pos=(binlog.000002, 895847264)"
time="2023-09-28T13:34:13-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:13-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:13-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:13-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:13-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:13-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:13-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:13-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=1 copy-rows-time=0s checksum-time=0s total-time=0s"
time="2023-09-28T13:34:13-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:13-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:13-07:00" level=info msg="kill last connection id 5020"
time="2023-09-28T13:34:13-07:00" level=info msg="syncer is closed"
    runner_test.go:1343: 
        	Error Trace:	/Users/kolbek/Devel/git/squareup/spirit/pkg/migration/runner_test.go:1343
        	Error:      	Not equal: 
        	            	expected: "_remainingtbl_old,remainingtbl"
        	            	actual  : "remainingtbl"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1 +1 @@
        	            	-_remainingtbl_old,remainingtbl
        	            	+remainingtbl
        	Test:       	TestForRemainingTableArtifacts
--- FAIL: TestForRemainingTableArtifacts (0.04s)
=== RUN   TestDropColumn
time="2023-09-28T13:34:13-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.dropcol alter=\"DROP COLUMN b, ENGINE=InnoDB\""
time="2023-09-28T13:34:13-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_dropcol_new'"
time="2023-09-28T13:34:13-07:00" level=info msg="create BinlogSyncer with config {1952 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x140007769a0 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:13-07:00" level=info msg="approaching the end of the table, synchronously updating statistics"
time="2023-09-28T13:34:13-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 895851318) or GTID set <nil>"
time="2023-09-28T13:34:13-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 895851318)"
time="2023-09-28T13:34:13-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 895851318)"
time="2023-09-28T13:34:13-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:13-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895852004) target-pos=(binlog.000002, 895851795)"
time="2023-09-28T13:34:13-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_dropcol_new`"
time="2023-09-28T13:34:13-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:13-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 895852610) target-pos=(binlog.000002, 895852401)"
time="2023-09-28T13:34:13-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:13-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:13-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:13-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:13-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:13-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:13-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:13-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=2 copy-rows-time=0s checksum-time=0s total-time=0s"
time="2023-09-28T13:34:13-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:13-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:13-07:00" level=info msg="kill last connection id 5031"
time="2023-09-28T13:34:13-07:00" level=info msg="syncer is closed"
--- PASS: TestDropColumn (0.04s)
=== RUN   TestDefaultPort
--- PASS: TestDefaultPort (0.00s)
=== RUN   TestNullToNotNull
time="2023-09-28T13:34:13-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.autodatetime alter=\"modify column created_at datetime(3) not null default current_timestamp(3)\""
time="2023-09-28T13:34:13-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_autodatetime_chkpnt'"
time="2023-09-28T13:34:13-07:00" level=info msg="create BinlogSyncer with config {1952 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000098a80 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:13-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 895856468) or GTID set <nil>"
time="2023-09-28T13:34:13-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 895856468)"
time="2023-09-28T13:34:13-07:00" level=info msg="approaching the end of the table, synchronously updating statistics"
time="2023-09-28T13:34:13-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 895856468)"
time="2023-09-28T13:34:13-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:13-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:13-07:00" level=info msg="kill last connection id 5039"
time="2023-09-28T13:34:13-07:00" level=info msg="syncer is closed"
--- PASS: TestNullToNotNull (0.03s)
=== RUN   TestChunkerPrefetching
time="2023-09-28T13:34:14-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.prefetchtest alter=\"engine=innodb\""
time="2023-09-28T13:34:14-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_prefetchtest_new'"
time="2023-09-28T13:34:14-07:00" level=info msg="create BinlogSyncer with config {1718 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x140005b2130 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:14-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 901384645) or GTID set <nil>"
time="2023-09-28T13:34:14-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 901384645)"
time="2023-09-28T13:34:14-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 901384645)"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=4000/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=16000/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=36000/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=62750/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=119375/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=183500/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=293178/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=425634/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=664807/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=1031147/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=1748623/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=2970034/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=5026360/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=warning msg="dynamic chunking is not working as expected: target-time=100ms p90-time=5.510459ms new-target-rows=1814730 max-dynamic-row-size=100000"
time="2023-09-28T13:34:14-07:00" level=warning msg="switching to prefetch algorithm"
time="2023-09-28T13:34:14-07:00" level=warning msg="disabling chunk prefetching: min-val=300000001500 max-val=300000003001 max-dynamic-row-size=100000"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=8183018/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9083018/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9084018/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9095018/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9102518/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9105518/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9108518/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9121518/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9132018/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9136518/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9138018/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9141018/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9147018/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9167268/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9169518/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9174018/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9176268/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9187518/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9205518/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9208893/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9212268/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9212268/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9215643/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9229143/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9259518/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9266268/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9266268/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9269643/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9269643/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9276393/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9289893/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:14-07:00" level=info msg="migration status: state=copyRows copy-progress=9293268/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=9328702/900000000000 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=9328702/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=9364136/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=9426458/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=9469444/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=9625208/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=9885929/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=10270378/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=10956405/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=11940690/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=13439480/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=warning msg="dynamic chunking is not working as expected: target-time=100ms p90-time=5.974291ms new-target-rows=1673838 max-dynamic-row-size=100000"
time="2023-09-28T13:34:15-07:00" level=warning msg="switching to prefetch algorithm"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=16011910/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=warning msg="disabling chunk prefetching: min-val=600000001500 max-val=600000003001 max-dynamic-row-size=100000"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=16911910/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=16911910/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=16927410/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=16929410/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=16931410/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=16945410/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=16951410/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=16954410/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=16960410/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=16976910/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=16978410/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=16980660/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=16987410/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=16998660/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17012160/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17018910/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17023410/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17032410/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17034660/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17034660/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17034660/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17034660/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17034660/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17041410/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17051535/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17068410/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17085285/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17098785/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17102160/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17102160/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17108910/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17108910/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17112285/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17143035/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17152410/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17158410/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17158410/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17164410/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17174515/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17196620/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17253775/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17374867/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17587277/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=17928964/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=18379154/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=19106384/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=20399804/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=copyRows copy-progress=21925679/900000000000 0.00% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:15-07:00" level=warning msg="dynamic chunking is not working as expected: target-time=100ms p90-time=6.281125ms new-target-rows=1592071 max-dynamic-row-size=100000"
time="2023-09-28T13:34:15-07:00" level=warning msg="switching to prefetch algorithm"
time="2023-09-28T13:34:15-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:15-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:15-07:00" level=info msg="migration status: state=applyChangeset binlog-deltas=0 total-time=1s"
time="2023-09-28T13:34:15-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 906979321) target-pos=(binlog.000002, 906979107)"
time="2023-09-28T13:34:15-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_prefetchtest_new`"
time="2023-09-28T13:34:15-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:15-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 906979942) target-pos=(binlog.000002, 906979728)"
time="2023-09-28T13:34:15-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:15-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:15-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:15-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:15-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:15-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:15-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:15-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=1021 copy-rows-time=1s checksum-time=0s total-time=1s"
time="2023-09-28T13:34:15-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:15-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:15-07:00" level=info msg="kill last connection id 5058"
time="2023-09-28T13:34:15-07:00" level=info msg="syncer is closed"
--- PASS: TestChunkerPrefetching (2.27s)
=== RUN   TestTpConversion
time="2023-09-28T13:34:15-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.tpconvert alter=\"MODIFY COLUMN created_at TIMESTAMP(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6),\n\t\tMODIFY COLUMN updated_at TIMESTAMP(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),\n\t\tMODIFY COLUMN issued_at TIMESTAMP(6) NULL,\n\t\tMODIFY COLUMN activated_at TIMESTAMP(6) NULL,\n\t\tMODIFY COLUMN deactivated_at TIMESTAMP(6) NULL,\n\t\tMODIFY COLUMN intasstring INT NULL DEFAULT NULL\n\t\t\""
time="2023-09-28T13:34:15-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_tpconvert_new'"
time="2023-09-28T13:34:15-07:00" level=info msg="create BinlogSyncer with config {1055 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000098420 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:15-07:00" level=info msg="approaching the end of the table, synchronously updating statistics"
time="2023-09-28T13:34:15-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 906984828) or GTID set <nil>"
time="2023-09-28T13:34:15-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 906984828)"
time="2023-09-28T13:34:15-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 906984828)"
time="2023-09-28T13:34:15-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:15-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:15-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 906986087) target-pos=(binlog.000002, 906985876)"
time="2023-09-28T13:34:15-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_tpconvert_new`"
time="2023-09-28T13:34:15-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:15-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000002, 906986699) target-pos=(binlog.000002, 906986488)"
time="2023-09-28T13:34:15-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:15-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:15-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:15-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:15-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:15-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:15-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:15-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=3 copy-rows-time=0s checksum-time=0s total-time=0s"
time="2023-09-28T13:34:15-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:15-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:15-07:00" level=info msg="kill last connection id 5124"
time="2023-09-28T13:34:15-07:00" level=info msg="syncer is closed"
--- PASS: TestTpConversion (0.04s)
=== RUN   TestResumeFromCheckpointE2E
time="2023-09-28T13:34:16-07:00" level=info msg="Starting spirit migration: concurrency=1 target-chunk-size=100ms table=test.chkpresumetest alter=\"ADD INDEX(pad);\""
time="2023-09-28T13:34:16-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_chkpresumetest_new'"
time="2023-09-28T13:34:16-07:00" level=info msg="create BinlogSyncer with config {1013 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x140023cd2b0 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:16-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 1011637999) or GTID set <nil>"
time="2023-09-28T13:34:16-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 1011637999)"
time="2023-09-28T13:34:16-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 1011637999)"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=1000/101040 0.99% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=1000/101040 0.99% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=1000/101040 0.99% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=2000/101040 1.98% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=2000/101040 1.98% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=3000/101040 2.97% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=3000/101040 2.97% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=4000/101040 3.96% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=4000/101040 3.96% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=5000/101040 4.95% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":1000,\"LowerBound\":{\"Value\": [\"3001\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"4001\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=3970 rows-copied-logical=5000"
time="2023-09-28T13:34:16-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:16-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:16-07:00" level=info msg="kill last connection id 5137"
time="2023-09-28T13:34:16-07:00" level=info msg="syncer is closed"
time="2023-09-28T13:34:16-07:00" level=info msg="Starting spirit migration: concurrency=4 target-chunk-size=5s table=test.chkpresumetest alter=\"ADD INDEX(pad);\""
time="2023-09-28T13:34:16-07:00" level=info msg="create BinlogSyncer with config {1013 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14001859630 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:16-07:00" level=warning msg="resuming from checkpoint. low-watermark: {\"Key\":[\"id\"],\"ChunkSize\":1000,\"LowerBound\":{\"Value\": [\"3001\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"4001\"],\"Inclusive\":false}} log-file: binlog.000002 log-pos: 1011637999 copy-rows: 3970"
time="2023-09-28T13:34:16-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000002, 1011637999) or GTID set <nil>"
time="2023-09-28T13:34:16-07:00" level=info msg="begin to sync binlog from position (binlog.000002, 1011637999)"
time="2023-09-28T13:34:16-07:00" level=info msg="start sync binlog at binlog file (binlog.000002, 1011637999)"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=5000/133110 3.76% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=6000/133110 4.51% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=6000/133110 4.51% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=6000/133110 4.51% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=6000/133110 4.51% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=6000/133110 4.51% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=6000/133110 4.51% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=6000/133110 4.51% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=6000/133110 4.51% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":1000,\"LowerBound\":{\"Value\": [\"3001\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"4001\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=3970 rows-copied-logical=6000"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=6000/133110 4.51% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=7000/133110 5.26% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=7000/133110 5.26% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=10000/133110 7.51% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=11000/133110 8.26% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=11000/133110 8.26% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=11000/133110 8.26% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=12000/133110 9.02% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=15000/133110 11.27% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=16000/133110 12.02% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":1000,\"LowerBound\":{\"Value\": [\"13001\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"14001\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=13970 rows-copied-logical=16000"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=16000/133110 12.02% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=16000/133110 12.02% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=17000/133110 12.77% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=17000/133110 12.77% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:16-07:00" level=info msg="migration status: state=copyRows copy-progress=17000/133110 12.77% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=17000/133110 12.77% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=17000/133110 12.77% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=17000/133110 12.77% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=17000/133110 12.77% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=17000/133110 12.77% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":1000,\"LowerBound\":{\"Value\": [\"14001\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"15001\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=14970 rows-copied-logical=17000"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=17000/133110 12.77% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=17000/133110 12.77% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=17000/133110 12.77% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=19000/133110 14.27% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=19000/133110 14.27% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=19000/133110 14.27% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=19000/133110 14.27% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=19000/133110 14.27% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=19000/133110 14.27% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=19000/133110 14.27% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=20500/133110 15.40% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":1500,\"LowerBound\":{\"Value\": [\"17001\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"18501\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=18470 rows-copied-logical=20500"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=20500/133110 15.40% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=22000/133110 16.53% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=22000/133110 16.53% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=22000/133110 16.53% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=22000/133110 16.53% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=22000/133110 16.53% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=22000/133110 16.53% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=22000/133110 16.53% binlog-deltas=0 total-time=1s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=22000/133110 16.53% binlog-deltas=0 total-time=1s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":1500,\"LowerBound\":{\"Value\": [\"17001\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"18501\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=19970 rows-copied-logical=22000"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=22000/133110 16.53% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=22000/133110 16.53% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=22000/133110 16.53% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=23500/133110 17.65% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=23500/133110 17.65% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=23500/133110 17.65% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=28000/133110 21.04% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=28000/133110 21.04% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=29500/133110 22.16% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=29500/133110 22.16% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":1500,\"LowerBound\":{\"Value\": [\"26001\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"27501\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=27470 rows-copied-logical=29500"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=29500/133110 22.16% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=29500/133110 22.16% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=29500/133110 22.16% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":1500,\"LowerBound\":{\"Value\": [\"32001\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"33501\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=33470 rows-copied-logical=35500"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":1500,\"LowerBound\":{\"Value\": [\"32001\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"33501\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=33470 rows-copied-logical=35500"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=35500/133110 26.67% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=37000/133110 27.80% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=37000/133110 27.80% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=42250/133110 31.74% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":2250,\"LowerBound\":{\"Value\": [\"38001\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"40251\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=40220 rows-copied-logical=42250"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=42250/133110 31.74% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=44500/133110 33.43% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=44500/133110 33.43% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=44500/133110 33.43% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=44500/133110 33.43% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=44500/133110 33.43% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=44500/133110 33.43% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=44500/133110 33.43% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=44500/133110 33.43% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=44500/133110 33.43% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":2250,\"LowerBound\":{\"Value\": [\"40251\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"42501\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=42470 rows-copied-logical=44500"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=44500/133110 33.43% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=44500/133110 33.43% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=44500/133110 33.43% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=44500/133110 33.43% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=44500/133110 33.43% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=44500/133110 33.43% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=46750/133110 35.12% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=51250/133110 38.50% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=51250/133110 38.50% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=53500/133110 40.19% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":2250,\"LowerBound\":{\"Value\": [\"49251\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"51501\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=51470 rows-copied-logical=53500"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=53500/133110 40.19% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=53500/133110 40.19% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=53500/133110 40.19% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=53500/133110 40.19% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=53500/133110 40.19% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=53500/133110 40.19% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=53500/133110 40.19% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=53500/133110 40.19% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=53500/133110 40.19% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=53500/133110 40.19% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":2250,\"LowerBound\":{\"Value\": [\"49251\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"51501\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=51470 rows-copied-logical=53500"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=53500/133110 40.19% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=53500/133110 40.19% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=53500/133110 40.19% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=53500/133110 40.19% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:17-07:00" level=info msg="migration status: state=copyRows copy-progress=53500/133110 40.19% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=55750/133110 41.88% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=55750/133110 41.88% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=55750/133110 41.88% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=58000/133110 43.57% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=60250/133110 45.26% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":2250,\"LowerBound\":{\"Value\": [\"53751\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"56001\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=58220 rows-copied-logical=60250"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=60250/133110 45.26% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=62500/133110 46.95% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=62500/133110 46.95% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=62500/133110 46.95% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=64750/133110 48.64% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=64750/133110 48.64% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=64750/133110 48.64% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=64750/133110 48.64% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=64750/133110 48.64% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=64750/133110 48.64% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":2250,\"LowerBound\":{\"Value\": [\"60501\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"62751\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=62720 rows-copied-logical=64750"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=64750/133110 48.64% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=64750/133110 48.64% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=64750/133110 48.64% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=64750/133110 48.64% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=64750/133110 48.64% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=64750/133110 48.64% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=64750/133110 48.64% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=64750/133110 48.64% binlog-deltas=0 total-time=1s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=64750/133110 48.64% binlog-deltas=0 total-time=2s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=67000/133110 50.33% binlog-deltas=0 total-time=2s copier-time=1s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":2250,\"LowerBound\":{\"Value\": [\"62751\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"65001\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=64970 rows-copied-logical=67000"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=67000/133110 50.33% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=67000/133110 50.33% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=67000/133110 50.33% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=69250/133110 52.02% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=71500/133110 53.71% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=71500/133110 53.71% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=71500/133110 53.71% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=71500/133110 53.71% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=71500/133110 53.71% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=71500/133110 53.71% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":2250,\"LowerBound\":{\"Value\": [\"67251\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"69501\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=69470 rows-copied-logical=71500"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=71500/133110 53.71% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=71500/133110 53.71% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=71500/133110 53.71% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=71500/133110 53.71% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=71500/133110 53.71% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=74875/133110 56.25% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=74875/133110 56.25% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=74875/133110 56.25% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=74875/133110 56.25% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=74875/133110 56.25% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":3375,\"LowerBound\":{\"Value\": [\"69501\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"72876\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=72845 rows-copied-logical=74875"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=74875/133110 56.25% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=74875/133110 56.25% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=74875/133110 56.25% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=74875/133110 56.25% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=74875/133110 56.25% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=74875/133110 56.25% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=78250/133110 58.79% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=78250/133110 58.79% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=78250/133110 58.79% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=78250/133110 58.79% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":3375,\"LowerBound\":{\"Value\": [\"72876\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"76251\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=76220 rows-copied-logical=78250"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=78250/133110 58.79% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=78250/133110 58.79% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=81625/133110 61.32% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=81625/133110 61.32% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=85000/133110 63.86% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=85000/133110 63.86% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=85000/133110 63.86% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=85000/133110 63.86% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=85000/133110 63.86% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=85000/133110 63.86% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":3375,\"LowerBound\":{\"Value\": [\"79626\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"83001\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=82970 rows-copied-logical=85000"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=85000/133110 63.86% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=85000/133110 63.86% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=85000/133110 63.86% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=85000/133110 63.86% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=85000/133110 63.86% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=88375/133110 66.39% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=88375/133110 66.39% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=88375/133110 66.39% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=88375/133110 66.39% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=88375/133110 66.39% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":3375,\"LowerBound\":{\"Value\": [\"83001\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"86376\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=86345 rows-copied-logical=88375"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=88375/133110 66.39% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=88375/133110 66.39% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=88375/133110 66.39% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=88375/133110 66.39% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=88375/133110 66.39% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=88375/133110 66.39% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=88375/133110 66.39% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=88375/133110 66.39% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=88375/133110 66.39% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=88375/133110 66.39% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":3375,\"LowerBound\":{\"Value\": [\"86376\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"89751\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=89720 rows-copied-logical=91750"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=91750/133110 68.93% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=91750/133110 68.93% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=91750/133110 68.93% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=91750/133110 68.93% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=91750/133110 68.93% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=91750/133110 68.93% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=91750/133110 68.93% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=91750/133110 68.93% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=95125/133110 71.46% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=95125/133110 71.46% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=98500/133110 74.00% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":3375,\"LowerBound\":{\"Value\": [\"93126\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"96501\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1011637999 rows-copied=96470 rows-copied-logical=98500"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=105250/133110 79.07% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="approaching the end of the table, synchronously updating statistics"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=135623/133110 101.89% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=DUE copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=135623/133110 101.89% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=DUE copier-is-throttled=false"
time="2023-09-28T13:34:18-07:00" level=info msg="migration status: state=copyRows copy-progress=135623/133110 101.89% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=DUE copier-is-throttled=false"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=copyRows copy-progress=135623/133110 101.89% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=DUE copier-is-throttled=false"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=copyRows copy-progress=138998/133110 104.42% binlog-deltas=0 total-time=2s copier-time=2s copier-remaining-time=DUE copier-is-throttled=false"
time="2023-09-28T13:34:19-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:19-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=applyChangeset binlog-deltas=0 total-time=2s"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43045187) target-pos=(binlog.000003, 43044971)"
time="2023-09-28T13:34:19-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_chkpresumetest_new`"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43045592) target-pos=(binlog.000003, 43045376)"
time="2023-09-28T13:34:19-07:00" level=info msg="starting checksum operation, this will require a table lock"
time="2023-09-28T13:34:19-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:19-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43045808) target-pos=(binlog.000003, 43045592)"
time="2023-09-28T13:34:19-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43046024) target-pos=(binlog.000003, 43045808)"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=checksum checksum-progress=TBD/133110 binlog-deltas=0 total-time=2s checksum-time=0s"
time="2023-09-28T13:34:19-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:19-07:00" level=info msg="table unlocked, starting checksum"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=checksum checksum-progress=TBD/133110 binlog-deltas=0 total-time=2s checksum-time=0s"
time="2023-09-28T13:34:19-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":5062,\"LowerBound\":{\"Value\": [\"131937\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"136999\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1016788697 rows-copied=102010 rows-copied-logical=144060"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=checksum checksum-progress=3001/133110 binlog-deltas=0 total-time=2s checksum-time=0s"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=checksum checksum-progress=8001/133110 binlog-deltas=0 total-time=2s checksum-time=0s"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=checksum checksum-progress=12001/133110 binlog-deltas=0 total-time=2s checksum-time=0s"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=checksum checksum-progress=14501/133110 binlog-deltas=0 total-time=2s checksum-time=0s"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=checksum checksum-progress=20501/133110 binlog-deltas=0 total-time=2s checksum-time=0s"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=checksum checksum-progress=32501/133110 binlog-deltas=0 total-time=2s checksum-time=0s"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=checksum checksum-progress=36251/133110 binlog-deltas=0 total-time=2s checksum-time=0s"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=checksum checksum-progress=47501/133110 binlog-deltas=0 total-time=2s checksum-time=0s"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=checksum checksum-progress=58751/133110 binlog-deltas=0 total-time=2s checksum-time=0s"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=checksum checksum-progress=61001/133110 binlog-deltas=0 total-time=2s checksum-time=0s"
time="2023-09-28T13:34:19-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":5062,\"LowerBound\":{\"Value\": [\"131937\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"136999\"],\"Inclusive\":false}} log-file=binlog.000002 log-pos=1016788697 rows-copied=102010 rows-copied-logical=144060"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=checksum checksum-progress=68876/133110 binlog-deltas=0 total-time=2s checksum-time=0s"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=checksum checksum-progress=75626/133110 binlog-deltas=0 total-time=2s checksum-time=0s"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=checksum checksum-progress=122875/133110 binlog-deltas=0 total-time=2s checksum-time=0s"
time="2023-09-28T13:34:19-07:00" level=info msg="checksum passed"
time="2023-09-28T13:34:19-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43047236) target-pos=(binlog.000003, 43047020)"
time="2023-09-28T13:34:19-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43047674) target-pos=(binlog.000003, 43047458)"
time="2023-09-28T13:34:19-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:19-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:19-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:19-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:19-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:19-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:19-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:19-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=61 copy-rows-time=2s checksum-time=0s total-time=2s"
time="2023-09-28T13:34:19-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:19-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:19-07:00" level=info msg="kill last connection id 5146"
time="2023-09-28T13:34:19-07:00" level=info msg="syncer is closed"
--- PASS: TestResumeFromCheckpointE2E (3.53s)
=== RUN   TestE2ERogueValues
time="2023-09-28T13:34:19-07:00" level=info msg="create BinlogSyncer with config {1098 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000a04750 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:19-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000003, 43067208) or GTID set <nil>"
time="2023-09-28T13:34:19-07:00" level=info msg="begin to sync binlog from position (binlog.000003, 43067208)"
time="2023-09-28T13:34:19-07:00" level=info msg="start sync binlog at binlog file (binlog.000003, 43067208)"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43084314) target-pos=(binlog.000003, 43084104)"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43084817) target-pos=(binlog.000003, 43084607)"
time="2023-09-28T13:34:19-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43085617) target-pos=(binlog.000003, 43085407)"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43085827) target-pos=(binlog.000003, 43085617)"
time="2023-09-28T13:34:19-07:00" level=info msg="starting checksum operation, this will require a table lock"
time="2023-09-28T13:34:19-07:00" level=warning msg="trying to acquire table lock, timeout: 30"
time="2023-09-28T13:34:19-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43086037) target-pos=(binlog.000003, 43085827)"
time="2023-09-28T13:34:19-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43086247) target-pos=(binlog.000003, 43086037)"
time="2023-09-28T13:34:19-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:19-07:00" level=info msg="table unlocked, starting checksum"
time="2023-09-28T13:34:19-07:00" level=info msg="checksum passed"
time="2023-09-28T13:34:19-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43086457) target-pos=(binlog.000003, 43086247)"
--- PASS: TestE2ERogueValues (0.06s)
=== RUN   TestPartitionedTable
time="2023-09-28T13:34:19-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.part1 alter=\"ENGINE=InnoDB\""
time="2023-09-28T13:34:19-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_part1_new'"
time="2023-09-28T13:34:19-07:00" level=info msg="create BinlogSyncer with config {1098 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000aad810 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:19-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000003, 43090355) or GTID set <nil>"
time="2023-09-28T13:34:19-07:00" level=info msg="begin to sync binlog from position (binlog.000003, 43090355)"
time="2023-09-28T13:34:19-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:19-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:19-07:00" level=info msg="start sync binlog at binlog file (binlog.000003, 43090355)"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43091072) target-pos=(binlog.000003, 43090865)"
time="2023-09-28T13:34:19-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_part1_new`"
time="2023-09-28T13:34:19-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43091672) target-pos=(binlog.000003, 43091465)"
time="2023-09-28T13:34:19-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:19-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:19-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:19-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:19-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:19-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:19-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:19-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=1 copy-rows-time=0s checksum-time=0s total-time=0s"
time="2023-09-28T13:34:19-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:19-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:19-07:00" level=info msg="kill last connection id 5186"
time="2023-09-28T13:34:19-07:00" level=info msg="syncer is closed"
--- PASS: TestPartitionedTable (0.11s)
=== RUN   TestResumeFromCheckpointPhantom
time="2023-09-28T13:34:19-07:00" level=info msg="create BinlogSyncer with config {1098 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000f1ac60 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:19-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000003, 43106158) or GTID set <nil>"
time="2023-09-28T13:34:19-07:00" level=info msg="begin to sync binlog from position (binlog.000003, 43106158)"
time="2023-09-28T13:34:19-07:00" level=info msg="start sync binlog at binlog file (binlog.000003, 43106158)"
time="2023-09-28T13:34:19-07:00" level=info msg="checkpoint: low-watermark={\"Key\":[\"id\"],\"ChunkSize\":1000,\"LowerBound\":{\"Value\": [\"1\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"1001\"],\"Inclusive\":false}} log-file=binlog.000003 log-pos=43106158 rows-copied=10 rows-copied-logical=2000"
time="2023-09-28T13:34:19-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:19-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:19-07:00" level=info msg="kill last connection id 5197"
time="2023-09-28T13:34:19-07:00" level=info msg="syncer is closed"
time="2023-09-28T13:34:19-07:00" level=info msg="create BinlogSyncer with config {1098 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000099660 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:19-07:00" level=warning msg="resuming from checkpoint. low-watermark: {\"Key\":[\"id\"],\"ChunkSize\":1000,\"LowerBound\":{\"Value\": [\"1\"],\"Inclusive\":true},\"UpperBound\":{\"Value\": [\"1001\"],\"Inclusive\":false}} log-file: binlog.000003 log-pos: 43106158 copy-rows: 10"
time="2023-09-28T13:34:19-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:19-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000003, 43106158) or GTID set <nil>"
time="2023-09-28T13:34:19-07:00" level=info msg="begin to sync binlog from position (binlog.000003, 43106158)"
time="2023-09-28T13:34:19-07:00" level=info msg="start sync binlog at binlog file (binlog.000003, 43106158)"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43121804) target-pos=(binlog.000003, 43121591)"
time="2023-09-28T13:34:19-07:00" level=info msg="approaching the end of the table, synchronously updating statistics"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43122198) target-pos=(binlog.000003, 43121985)"
time="2023-09-28T13:34:19-07:00" level=info msg="starting checksum operation, this will require a table lock"
time="2023-09-28T13:34:19-07:00" level=warning msg="trying to acquire table lock, timeout: 30"
time="2023-09-28T13:34:19-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43122411) target-pos=(binlog.000003, 43122198)"
time="2023-09-28T13:34:19-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43123943) target-pos=(binlog.000003, 43123730)"
time="2023-09-28T13:34:19-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:19-07:00" level=info msg="table unlocked, starting checksum"
time="2023-09-28T13:34:19-07:00" level=info msg="checksum passed"
time="2023-09-28T13:34:19-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:19-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 43124156) target-pos=(binlog.000003, 43123943)"
--- PASS: TestResumeFromCheckpointPhantom (0.09s)
=== RUN   TestVarcharE2E
time="2023-09-28T13:34:19-07:00" level=info msg="Starting spirit migration: concurrency=16 target-chunk-size=100ms table=test.varchart1 alter=\"ENGINE=InnoDB\""
time="2023-09-28T13:34:19-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_varchart1_new'"
time="2023-09-28T13:34:19-07:00" level=info msg="create BinlogSyncer with config {1098 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x140007f0040 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:19-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000003, 47693026) or GTID set <nil>"
time="2023-09-28T13:34:19-07:00" level=info msg="begin to sync binlog from position (binlog.000003, 47693026)"
time="2023-09-28T13:34:19-07:00" level=info msg="start sync binlog at binlog file (binlog.000003, 47693026)"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=copyRows copy-progress=0/98211 0.00% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=copyRows copy-progress=1000/98211 1.02% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=copyRows copy-progress=3002/98211 3.06% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=copyRows copy-progress=10009/98211 10.19% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=copyRows copy-progress=14013/98211 14.27% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=copyRows copy-progress=20019/98211 20.38% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=copyRows copy-progress=29027/98211 29.56% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=copyRows copy-progress=30528/98211 31.08% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=copyRows copy-progress=33530/98211 34.14% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=copyRows copy-progress=36532/98211 37.20% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=copyRows copy-progress=54544/98211 55.54% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=copyRows copy-progress=57546/98211 58.59% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:19-07:00" level=info msg="migration status: state=copyRows copy-progress=62049/98211 63.18% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:20-07:00" level=info msg="migration status: state=copyRows copy-progress=63550/98211 64.71% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:20-07:00" level=info msg="migration status: state=copyRows copy-progress=67302/98211 68.53% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:20-07:00" level=info msg="migration status: state=copyRows copy-progress=67302/98211 68.53% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:20-07:00" level=info msg="migration status: state=copyRows copy-progress=69553/98211 70.82% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:20-07:00" level=info msg="migration status: state=copyRows copy-progress=92063/98211 93.74% binlog-deltas=0 total-time=0s copier-time=0s copier-remaining-time=TBD copier-is-throttled=false"
time="2023-09-28T13:34:20-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:20-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:20-07:00" level=info msg="migration status: state=applyChangeset binlog-deltas=0 total-time=0s"
time="2023-09-28T13:34:20-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 51361122) target-pos=(binlog.000003, 52276584)"
time="2023-09-28T13:34:20-07:00" level=info msg="migration status: state=applyChangeset binlog-deltas=0 total-time=0s"
time="2023-09-28T13:34:20-07:00" level=info msg="migration status: state=applyChangeset binlog-deltas=0 total-time=0s"
time="2023-09-28T13:34:20-07:00" level=info msg="migration status: state=applyChangeset binlog-deltas=0 total-time=0s"
time="2023-09-28T13:34:20-07:00" level=info msg="migration status: state=applyChangeset binlog-deltas=0 total-time=0s"
time="2023-09-28T13:34:20-07:00" level=info msg="migration status: state=applyChangeset binlog-deltas=0 total-time=0s"
time="2023-09-28T13:34:20-07:00" level=info msg="migration status: state=applyChangeset binlog-deltas=0 total-time=0s"
time="2023-09-28T13:34:20-07:00" level=info msg="migration status: state=applyChangeset binlog-deltas=0 total-time=0s"
time="2023-09-28T13:34:20-07:00" level=info msg="migration status: state=applyChangeset binlog-deltas=0 total-time=0s"
time="2023-09-28T13:34:20-07:00" level=info msg="migration status: state=applyChangeset binlog-deltas=0 total-time=0s"
time="2023-09-28T13:34:20-07:00" level=info msg="migration status: state=applyChangeset binlog-deltas=0 total-time=0s"
time="2023-09-28T13:34:20-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_varchart1_new`"
time="2023-09-28T13:34:20-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:20-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 52277618) target-pos=(binlog.000003, 52277407)"
time="2023-09-28T13:34:20-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:20-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:20-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:20-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:20-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:20-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:20-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:20-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=68 copy-rows-time=0s checksum-time=0s total-time=0s"
time="2023-09-28T13:34:20-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:20-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:20-07:00" level=info msg="kill last connection id 5230"
time="2023-09-28T13:34:20-07:00" level=info msg="syncer is closed"
--- PASS: TestVarcharE2E (0.71s)
=== RUN   TestSkipDropAfterCutover
time="2023-09-28T13:34:20-07:00" level=info msg="Starting spirit migration: concurrency=4 target-chunk-size=100ms table=test.drop_test alter=\"ENGINE=InnoDB\""
time="2023-09-28T13:34:20-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_drop_test_new'"
time="2023-09-28T13:34:20-07:00" level=info msg="create BinlogSyncer with config {1883 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x140002a0230 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:20-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000003, 52281036) or GTID set <nil>"
time="2023-09-28T13:34:20-07:00" level=info msg="begin to sync binlog from position (binlog.000003, 52281036)"
time="2023-09-28T13:34:20-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:20-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:20-07:00" level=info msg="start sync binlog at binlog file (binlog.000003, 52281036)"
time="2023-09-28T13:34:20-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 52281247) target-pos=(binlog.000003, 52281036)"
time="2023-09-28T13:34:20-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_drop_test_new`"
time="2023-09-28T13:34:20-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:20-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 52281859) target-pos=(binlog.000003, 52281648)"
time="2023-09-28T13:34:20-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:20-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:20-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:20-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:20-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:20-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:20-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=1 copy-rows-time=0s checksum-time=0s total-time=0s"
time="2023-09-28T13:34:20-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:20-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:20-07:00" level=info msg="kill last connection id 5268"
time="2023-09-28T13:34:20-07:00" level=info msg="syncer is closed"
--- PASS: TestSkipDropAfterCutover (0.04s)
=== RUN   TestDropAfterCutover
time="2023-09-28T13:34:20-07:00" level=info msg="Starting spirit migration: concurrency=4 target-chunk-size=100ms table=test.drop_test alter=\"ENGINE=InnoDB\""
time="2023-09-28T13:34:20-07:00" level=info msg="could not resume from checkpoint: reason=could not read from table '_drop_test_new'"
time="2023-09-28T13:34:20-07:00" level=info msg="create BinlogSyncer with config {1883 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000b02b60 0x10124cce0 <nil> false}"
time="2023-09-28T13:34:20-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000003, 52285060) or GTID set <nil>"
time="2023-09-28T13:34:20-07:00" level=info msg="begin to sync binlog from position (binlog.000003, 52285060)"
time="2023-09-28T13:34:20-07:00" level=info msg="copy rows complete"
time="2023-09-28T13:34:20-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:20-07:00" level=info msg="start sync binlog at binlog file (binlog.000003, 52285060)"
time="2023-09-28T13:34:20-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 52285271) target-pos=(binlog.000003, 52285060)"
time="2023-09-28T13:34:20-07:00" level=info msg="Running: ANALYZE TABLE `test`.`_drop_test_new`"
time="2023-09-28T13:34:20-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T13:34:20-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000003, 52285883) target-pos=(binlog.000003, 52285672)"
time="2023-09-28T13:34:20-07:00" level=warning msg="Attempting final cut over operation (attempt 1/5)"
time="2023-09-28T13:34:20-07:00" level=info msg="Using cutover algorithm: rename-under-lock"
time="2023-09-28T13:34:20-07:00" level=warning msg="trying to acquire table lock, timeout: 0"
time="2023-09-28T13:34:20-07:00" level=warning msg="table lock acquired"
time="2023-09-28T13:34:20-07:00" level=warning msg="table lock released"
time="2023-09-28T13:34:20-07:00" level=warning msg="final cut over operation complete"
time="2023-09-28T13:34:20-07:00" level=info msg="successfully dropped old table"
time="2023-09-28T13:34:20-07:00" level=info msg="apply complete: instant-ddl=false inplace-ddl=false total-chunks=1 copy-rows-time=0s checksum-time=0s total-time=0s"
time="2023-09-28T13:34:20-07:00" level=info msg="closing canal"
time="2023-09-28T13:34:20-07:00" level=info msg="syncer is closing..."
time="2023-09-28T13:34:20-07:00" level=info msg="kill last connection id 5276"
time="2023-09-28T13:34:20-07:00" level=info msg="syncer is closed"
--- PASS: TestDropAfterCutover (0.04s)
FAIL
FAIL	github.com/squareup/spirit/pkg/migration	15.031s
=== RUN   TestReplClient
time="2023-09-28T12:42:53-07:00" level=info msg="create BinlogSyncer with config {1374 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000031b10 0x10268e830 <nil> false}"
time="2023-09-28T12:42:53-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000001, 1034808) or GTID set <nil>"
time="2023-09-28T12:42:53-07:00" level=info msg="begin to sync binlog from position (binlog.000001, 1034808)"
time="2023-09-28T12:42:53-07:00" level=info msg="start sync binlog at binlog file (binlog.000001, 1034808)"
time="2023-09-28T12:42:53-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 1034808) target-pos=(binlog.000001, 1035095)"
time="2023-09-28T12:42:53-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T12:42:53-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 1036006) target-pos=(binlog.000001, 1035798)"
time="2023-09-28T12:42:53-07:00" level=info msg="closing canal"
time="2023-09-28T12:42:53-07:00" level=info msg="syncer is closing..."
time="2023-09-28T12:42:53-07:00" level=info msg="kill last connection id 156"
time="2023-09-28T12:42:53-07:00" level=info msg="syncer is closed"
--- PASS: TestReplClient (0.13s)
=== RUN   TestReplClientComplex
time="2023-09-28T12:42:53-07:00" level=info msg="create BinlogSyncer with config {1374 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x140003c0de0 0x10268e830 <nil> false}"
time="2023-09-28T12:42:53-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000001, 2450305) or GTID set <nil>"
time="2023-09-28T12:42:53-07:00" level=info msg="begin to sync binlog from position (binlog.000001, 2450305)"
time="2023-09-28T12:42:53-07:00" level=info msg="start sync binlog at binlog file (binlog.000001, 2450305)"
time="2023-09-28T12:42:53-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 2457093) target-pos=(binlog.000001, 2456878)"
time="2023-09-28T12:42:54-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 2457719) target-pos=(binlog.000001, 2457504)"
time="2023-09-28T12:42:54-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T12:42:54-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 2457934) target-pos=(binlog.000001, 2457719)"
time="2023-09-28T12:42:54-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 2458560) target-pos=(binlog.000001, 2458345)"
time="2023-09-28T12:42:54-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 2470308) target-pos=(binlog.000001, 2470093)"
time="2023-09-28T12:42:54-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T12:42:54-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 2476407) target-pos=(binlog.000001, 2476192)"
time="2023-09-28T12:42:54-07:00" level=info msg="closing canal"
time="2023-09-28T12:42:54-07:00" level=info msg="syncer is closing..."
time="2023-09-28T12:42:54-07:00" level=info msg="kill last connection id 214"
time="2023-09-28T12:42:54-07:00" level=info msg="syncer is closed"
--- PASS: TestReplClientComplex (0.27s)
=== RUN   TestReplClientResumeFromImpossible
time="2023-09-28T12:42:54-07:00" level=info msg="create BinlogSyncer with config {1727 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000018ce0 0x10268e830 <nil> false}"
--- PASS: TestReplClientResumeFromImpossible (0.01s)
=== RUN   TestReplClientResumeFromPoint
time="2023-09-28T12:42:54-07:00" level=info msg="create BinlogSyncer with config {1727 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000031a70 0x10268e830 <nil> false}"
time="2023-09-28T12:42:54-07:00" level=info msg="closing canal"
time="2023-09-28T12:42:54-07:00" level=info msg="syncer is closing..."
time="2023-09-28T12:42:54-07:00" level=info msg="syncer is closed"
--- PASS: TestReplClientResumeFromPoint (0.01s)
=== RUN   TestReplClientOpts
time="2023-09-28T12:42:54-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000001, 2478808) or GTID set <nil>"
time="2023-09-28T12:42:54-07:00" level=info msg="begin to sync binlog from position (binlog.000001, 2478808)"
time="2023-09-28T12:42:54-07:00" level=error msg="canal start sync binlog err: start sync replication at binlog (binlog.000001, 2478808) error Sync was closed"
time="2023-09-28T12:42:54-07:00" level=info msg="create BinlogSyncer with config {1727 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000328590 0x10268e830 <nil> false}"
time="2023-09-28T12:42:54-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000001, 3805932) or GTID set <nil>"
time="2023-09-28T12:42:54-07:00" level=info msg="begin to sync binlog from position (binlog.000001, 3805932)"
time="2023-09-28T12:42:54-07:00" level=info msg="start sync binlog at binlog file (binlog.000001, 3805932)"
time="2023-09-28T12:42:54-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 3805932) target-pos=(binlog.000001, 4458475)"
time="2023-09-28T12:42:55-07:00" level=info msg="starting periodic flush of binary log"
time="2023-09-28T12:42:55-07:00" level=info msg="finished periodic flush of binary log: duration=19.259458ms"
time="2023-09-28T12:42:56-07:00" level=info msg="starting periodic flush of binary log"
time="2023-09-28T12:42:56-07:00" level=info msg="finished periodic flush of binary log: duration=1.013875ms"
time="2023-09-28T12:42:56-07:00" level=info msg="closing canal"
time="2023-09-28T12:42:56-07:00" level=info msg="syncer is closing..."
time="2023-09-28T12:42:56-07:00" level=info msg="kill last connection id 270"
time="2023-09-28T12:42:56-07:00" level=info msg="syncer is closed"
--- PASS: TestReplClientOpts (2.44s)
=== RUN   TestReplClientQueue
time="2023-09-28T12:42:57-07:00" level=info msg="create BinlogSyncer with config {1192 mysql 127.0.0.1 3306 root   utf8 false false <nil> false UTC false 0 0s 0s 0 false false 0 <nil> 0x14000782fb0 0x10268e830 <nil> false}"
time="2023-09-28T12:42:57-07:00" level=info msg="skip dump, use last binlog replication pos (binlog.000001, 9231512) or GTID set <nil>"
time="2023-09-28T12:42:57-07:00" level=info msg="begin to sync binlog from position (binlog.000001, 9231512)"
time="2023-09-28T12:42:57-07:00" level=info msg="start sync binlog at binlog file (binlog.000001, 9231512)"
time="2023-09-28T12:42:57-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 9279186) target-pos=(binlog.000001, 9278973)"
time="2023-09-28T12:42:57-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 9303302) target-pos=(binlog.000001, 9303089)"
time="2023-09-28T12:42:57-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T12:42:57-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 9327418) target-pos=(binlog.000001, 9327205)"
time="2023-09-28T12:42:57-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 9332617) target-pos=(binlog.000001, 9332404)"
time="2023-09-28T12:42:57-07:00" level=info msg="starting to flush changeset"
time="2023-09-28T12:42:57-07:00" level=info msg="blocking until we have read all binary logs: current-pos=(binlog.000001, 9332830) target-pos=(binlog.000001, 9332617)"
time="2023-09-28T12:42:57-07:00" level=info msg="closing canal"
time="2023-09-28T12:42:57-07:00" level=info msg="syncer is closing..."
time="2023-09-28T12:42:57-07:00" level=info msg="kill last connection id 299"
time="2023-09-28T12:42:57-07:00" level=info msg="syncer is closed"
--- PASS: TestReplClientQueue (0.77s)
=== RUN   TestLogWrapper
time="2023-09-28T12:42:57-07:00" level=info msg=info
time="2023-09-28T12:42:57-07:00" level=warning msg=warn
time="2023-09-28T12:42:57-07:00" level=error msg=error
time="2023-09-28T12:42:57-07:00" level=info msg=infoln
time="2023-09-28T12:42:57-07:00" level=warning msg=warnln
time="2023-09-28T12:42:57-07:00" level=error msg=errorln
time="2023-09-28T12:42:57-07:00" level=info msg="infof test"
time="2023-09-28T12:42:57-07:00" level=warning msg="warnf test"
time="2023-09-28T12:42:57-07:00" level=error msg="errorf test"
time="2023-09-28T12:42:57-07:00" level=info msg=print
time="2023-09-28T12:42:57-07:00" level=info msg="printf test"
time="2023-09-28T12:42:57-07:00" level=info msg=println
--- PASS: TestLogWrapper (0.00s)
PASS
ok  	github.com/squareup/spirit/pkg/repl	(cached)
=== RUN   TestCopier
--- PASS: TestCopier (0.02s)
=== RUN   TestThrottler
--- PASS: TestThrottler (0.01s)
=== RUN   TestCopierUniqueDestination
--- PASS: TestCopierUniqueDestination (0.02s)
=== RUN   TestCopierLossyDataTypeConversion
--- PASS: TestCopierLossyDataTypeConversion (0.01s)
=== RUN   TestCopierNullToNotNullConversion
--- PASS: TestCopierNullToNotNullConversion (0.01s)
=== RUN   TestSQLModeAllowZeroInvalidDates
--- PASS: TestSQLModeAllowZeroInvalidDates (0.01s)
=== RUN   TestLockWaitTimeoutIsRetyable
--- PASS: TestLockWaitTimeoutIsRetyable (2.01s)
=== RUN   TestLockWaitTimeoutRetryExceeded
--- PASS: TestLockWaitTimeoutRetryExceeded (15.09s)
=== RUN   TestCopierValidation
--- PASS: TestCopierValidation (0.00s)
=== RUN   TestETA
--- PASS: TestETA (0.03s)
=== RUN   TestCopierFromCheckpoint
--- PASS: TestCopierFromCheckpoint (0.01s)
PASS
ok  	github.com/squareup/spirit/pkg/row	(cached)
=== RUN   TestChunk2String
--- PASS: TestChunk2String (0.00s)
=== RUN   TestBoundary_ValueString
--- PASS: TestBoundary_ValueString (0.00s)
=== RUN   TestCompositeChunks
--- PASS: TestCompositeChunks (0.00s)
=== RUN   TestComparesTo
--- PASS: TestComparesTo (0.00s)
=== RUN   TestCompositeChunkerCompositeBinary
--- PASS: TestCompositeChunkerCompositeBinary (3.81s)
=== RUN   TestCompositeChunkerBinary
--- PASS: TestCompositeChunkerBinary (3.03s)
=== RUN   TestCompositeChunkerInt
--- PASS: TestCompositeChunkerInt (5.09s)
=== RUN   TestCompositeLowWatermark
time="2023-09-28T12:43:05-07:00" level=info msg="high chunk processing time. time: 1s threshold: 500ms target-rows: 1000 target-ms: 100ms new-target-rows: 100"
time="2023-09-28T12:43:05-07:00" level=info msg="high chunk processing time. time: 1s threshold: 500ms target-rows: 100 target-ms: 100ms new-target-rows: 10"
time="2023-09-28T12:43:05-07:00" level=info msg="high chunk processing time. time: 1s threshold: 500ms target-rows: 10 target-ms: 100ms new-target-rows: 1"
time="2023-09-28T12:43:05-07:00" level=info msg="high chunk processing time. time: 1s threshold: 500ms target-rows: 10 target-ms: 100ms new-target-rows: 1"
time="2023-09-28T12:43:05-07:00" level=info msg="high chunk processing time. time: 1s threshold: 500ms target-rows: 10 target-ms: 100ms new-target-rows: 1"
time="2023-09-28T12:43:05-07:00" level=info msg="high chunk processing time. time: 1s threshold: 500ms target-rows: 10 target-ms: 100ms new-target-rows: 1"
--- PASS: TestCompositeLowWatermark (0.04s)
=== RUN   TestCompositeSmallTable
--- PASS: TestCompositeSmallTable (0.01s)
=== RUN   TestSetKey
--- PASS: TestSetKey (0.11s)
=== RUN   TestSetKeyCompositeKeyMerge
--- PASS: TestSetKeyCompositeKeyMerge (0.01s)
=== RUN   TestOptimisticChunkerBasic
--- PASS: TestOptimisticChunkerBasic (0.00s)
=== RUN   TestLowWatermark
--- PASS: TestLowWatermark (0.00s)
=== RUN   TestOptimisticDynamicChunking
time="2023-09-28T12:43:06-07:00" level=info msg="high chunk processing time. time: 1s threshold: 500ms target-rows: 1000 target-ms: 100ms new-target-rows: 100"
time="2023-09-28T12:43:06-07:00" level=info msg="high chunk processing time. time: 1s threshold: 500ms target-rows: 100 target-ms: 100ms new-target-rows: 10"
--- PASS: TestOptimisticDynamicChunking (0.00s)
=== RUN   TestOptimisticPrefetchChunking
time="2023-09-28T12:43:07-07:00" level=warning msg="dynamic chunking is not working as expected: target-time=1s p90-time=100ms new-target-rows=1000000 max-dynamic-row-size=100000"
time="2023-09-28T12:43:07-07:00" level=warning msg="switching to prefetch algorithm"
time="2023-09-28T12:43:07-07:00" level=warning msg="disabling chunk prefetching: min-val=300000001500 max-val=300000003001 max-dynamic-row-size=100000"
time="2023-09-28T12:43:07-07:00" level=warning msg="dynamic chunking is not working as expected: target-time=1s p90-time=100ms new-target-rows=1000000 max-dynamic-row-size=100000"
time="2023-09-28T12:43:07-07:00" level=warning msg="switching to prefetch algorithm"
time="2023-09-28T12:43:07-07:00" level=warning msg="disabling chunk prefetching: min-val=600000001500 max-val=600000003001 max-dynamic-row-size=100000"
time="2023-09-28T12:43:07-07:00" level=warning msg="dynamic chunking is not working as expected: target-time=1s p90-time=100ms new-target-rows=1000000 max-dynamic-row-size=100000"
time="2023-09-28T12:43:07-07:00" level=warning msg="switching to prefetch algorithm"
--- PASS: TestOptimisticPrefetchChunking (1.95s)
=== RUN   TestCompositeChunker
--- PASS: TestCompositeChunker (0.02s)
=== RUN   TestOptimisticChunker
--- PASS: TestOptimisticChunker (0.01s)
=== RUN   TestNewCompositeChunker
--- PASS: TestNewCompositeChunker (0.07s)
=== RUN   TestDatum
--- PASS: TestDatum (0.00s)
=== RUN   TestOpenOnBinaryType
--- PASS: TestOpenOnBinaryType (0.00s)
=== RUN   TestOpenOnNoMinMax
--- PASS: TestOpenOnNoMinMax (0.00s)
=== RUN   TestCallingNextChunkWithoutOpen
--- PASS: TestCallingNextChunkWithoutOpen (0.00s)
=== RUN   TestDiscovery
--- PASS: TestDiscovery (0.10s)
=== RUN   TestDiscoveryUInt
--- PASS: TestDiscoveryUInt (0.09s)
=== RUN   TestDiscoveryNoKeyColumnsOrNoTable
--- PASS: TestDiscoveryNoKeyColumnsOrNoTable (0.02s)
=== RUN   TestDiscoveryBalancesTable
--- PASS: TestDiscoveryBalancesTable (0.19s)
=== RUN   TestDiscoveryCompositeNonComparable
--- PASS: TestDiscoveryCompositeNonComparable (0.02s)
=== RUN   TestDiscoveryCompositeComparable
--- PASS: TestDiscoveryCompositeComparable (0.02s)
=== RUN   TestStatisticsUpdate
time="2023-09-28T12:43:08-07:00" level=info msg="table statistics updated: estimated-rows=3 pk[0].max-value=3"
time="2023-09-28T12:43:08-07:00" level=info msg="table statistics updated: estimated-rows=3 pk[0].max-value=3"
time="2023-09-28T12:43:08-07:00" level=info msg="table statistics updated: estimated-rows=3 pk[0].max-value=3"
time="2023-09-28T12:43:08-07:00" level=info msg="table statistics updated: estimated-rows=3 pk[0].max-value=3"
time="2023-09-28T12:43:08-07:00" level=info msg="table statistics updated: estimated-rows=3 pk[0].max-value=3"
time="2023-09-28T12:43:08-07:00" level=info msg="table statistics updated: estimated-rows=3 pk[0].max-value=3"
time="2023-09-28T12:43:08-07:00" level=info msg="table statistics updated: estimated-rows=3 pk[0].max-value=3"
--- PASS: TestStatisticsUpdate (0.11s)
=== RUN   TestKeyColumnsValuesExtraction
time="2023-09-28T12:43:08-07:00" level=info msg="table statistics updated: estimated-rows=3 pk[0].max-value=3"
time="2023-09-28T12:43:08-07:00" level=info msg="table statistics updated: estimated-rows=3 pk[0].max-value=3"
--- PASS: TestKeyColumnsValuesExtraction (0.01s)
=== RUN   TestFindP90
--- PASS: TestFindP90 (0.00s)
=== RUN   TestCastableTp
--- PASS: TestCastableTp (0.00s)
=== RUN   TestQuoteCols
--- PASS: TestQuoteCols (0.00s)
=== RUN   TestMySQLRealEscapeString
--- PASS: TestMySQLRealEscapeString (0.00s)
=== RUN   TestExpandRowConstructorComparison
--- PASS: TestExpandRowConstructorComparison (0.00s)
PASS
ok  	github.com/squareup/spirit/pkg/table	(cached)
=== RUN   TestThrottlerInterface
    throttler_test.go:18: skipping test because REPLICA_DSN not set
--- SKIP: TestThrottlerInterface (0.00s)
=== RUN   TestMySQL57Throttler
    throttler_test.go:41: skipping test because REPLICA_DSN not set
--- SKIP: TestMySQL57Throttler (0.00s)
=== RUN   TestNoopThrottler
--- PASS: TestNoopThrottler (0.00s)
PASS
ok  	github.com/squareup/spirit/pkg/throttler	(cached)
=== RUN   TestIntersectColumns
--- PASS: TestIntersectColumns (0.00s)
=== RUN   TestMySQLRealEscapeString
--- PASS: TestMySQLRealEscapeString (0.00s)
=== RUN   TestHashAndUnhashKey
--- PASS: TestHashAndUnhashKey (0.00s)
=== RUN   TestStripPort
--- PASS: TestStripPort (0.00s)
PASS
ok  	github.com/squareup/spirit/pkg/utils	(cached)
FAIL
